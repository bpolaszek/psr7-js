(function(l,h){typeof exports=="object"&&typeof module<"u"?h(exports,require("deepmerge")):typeof define=="function"&&define.amd?define(["exports","deepmerge"],h):(l=typeof globalThis<"u"?globalThis:l||self,h(l["psr7-js"]={},l.merge))})(this,function(l,h){"use strict";const b=(t=>t&&typeof t=="object"&&"default"in t?t:{default:t})(h);function f(t){return/boolean|number|string/.test(typeof t)}const m="http://localhost";class u{constructor(r=P()){if(!(r instanceof URL)&&!f(r))throw TypeError("Expected string, got "+typeof r);try{this.url=new URL(r),this.absolute=!0}catch{this.url=new URL(m+(r.indexOf("/")===0?"":"/")+r),this.absolute=!1}}getScheme(){return this.absolute?this.url.protocol.substr(0,this.url.protocol.length-1):""}getUserInfo(){if(!this.absolute||this.url.username.length===0&&this.url.password.length===0)return"";let r=this.url.username;return this.url.password.length!==0&&(r=r+":"+this.url.password),r}getHost(){return this.absolute?this.url.hostname:""}getPort(){return!this.absolute||this.url.port.length===0?null:parseInt(this.url.port)}getPath(){return this.url.pathname}getQuery(){return this.url.search.substr(1)}getFragment(){return this.url.hash.substr(1)}toString(){const r=this.url.toString();return this.absolute?r:r.substr(m.length,r.length-m.length)}withScheme(r){let e=new u(this.url.toString());return e.url.protocol=a(r),e}withUserInfo(r,e=""){let s=new u(this.url.toString());return s.url.username=a(r),s.url.password=a(e),s}withHost(r){let e=new u(this.url.toString());return e.url.hostname=a(r),e}withPort(r){let e=new u(this.url.toString());return e.url.port=a(r),e}withPath(r){let e=new u(this.url.toString());return e.url.pathname=a(r),e.absolute=this.absolute,e}withQuery(r){let e=new u(this.url.toString());return e.url.search=a(r),e.absolute=this.absolute,e}withFragment(r){let e=new u(this.url.toString());return e.url.hash=a(r),e.absolute=this.absolute,e}}function P(){return typeof window<"u"?window.location.href:"/"}function a(t){if(t===null||typeof t>"u")return"";if(typeof t=="object"&&typeof t.toString=="function")return t.toString();if(!f(t))throw TypeError("Unexpected value");return t}function S(t){if(t.indexOf("[")===-1)return[t];const r=t.split("[")[0],e=t.match(/\[(.*?)\]/g).map(s=>{const n=s.substr(1).substr(0,s.length-2);return n.length!==0?n:null});return r===""?e:[r,...e]}const j=t=>t===null?null:isNaN(t)===!1?typeof t=="string"&&t.startsWith("0")?t:Number.isInteger(t)?parseInt(t):parseFloat(t):f(t)&&["true","on"].includes(t.toLowerCase())?!0:f(t)&&["false","off"].includes(t.toLowerCase())?!1:t;function y(t,r){const e={};let s,n,o=e;for(let i=0;i<t.length;i++){if(s=t[i],t[i-1],n=t[i+1],typeof n>"u"){if(Array.isArray(o)){o.push(r);break}o[s]=j(r);break}if(Array.isArray(o)){o.push(y(t.slice(i+1,t.length),r));break}o[s]=n===null?[]:{},o=o[s]}return e}function g(t){t.indexOf("?")===0&&(t=t.substr(1));const r=t.split("&");let e={};for(let s of r){let n=s.split("=");if(n[0].length===0&&(!f(n[1])||n[1].length===0))continue;let o=S(decodeURIComponent(n[0])),i=typeof n[1]>"u"||n[1]===""?null:decodeURIComponent(n[1]);e=b.default(e,y(o,i))}return e}function w(t){var r,e;if(t instanceof URL)return g(t.search);if(t instanceof u)return g(t.getQuery());if(f(t))return g(t);if(typeof t>"u")try{return g((e=(r=window==null?void 0:window.location)==null?void 0:r.search)!=null?e:"")}catch{return{}}if(Array.isArray(t)||typeof t!="object")throw TypeError("Invalid type for params.");return t}function d(t,r,e="&"){return r.length>0?r+e+t:r+t}function p(t,r=null,e=""){if(f(t))return d(r===null?encodeURIComponent(t):encodeURIComponent(r)+"="+encodeURIComponent(t),e);const s=Array.isArray(t);for(let n in t)if(!!t.hasOwnProperty(n)){if(r===null){e=p(t[n],n,e);continue}if(s){e=d(p(t[n],encodeURIComponent(r)+"[]"),e);continue}e=d(p(t[n],encodeURIComponent(r)+"["+encodeURIComponent(n)+"]"),e)}return e}class c{constructor(r){this.params=w(r)}getParams(){return this.params}getParam(r){let e,s=this.params;for(let n=0;n<arguments.length;n++){if(e=arguments[n],!s.hasOwnProperty(e))return;s=s[e]}return s}hasParam(r){let e,s=this.params;for(let n=0;n<arguments.length;n++){if(e=arguments[n],!s.hasOwnProperty(e))return!1;s=s[e]}return!0}withParam(r,e,s=!0){const n=S(r);Object.assign({},this.params);let o=y(n,e);return this.withParams(o,s)}withParams(r,e=!0){return e===!1?new c(Object.assign({},this.params,w(r))):new c(b.default(this.params,w(r)))}withoutParam(r){let e=Object.assign({},this.params),s,n=e;for(let o=0,i=1;o<arguments.length;o++,i++){if(s=arguments[o],i===arguments.length){delete n[s];break}n=n[s]}return new c(e)}toString(){return p(this.params)}toJson(){return JSON.stringify(this.params,...arguments)}}l.QueryString=c,l.URI=u,Object.defineProperties(l,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
